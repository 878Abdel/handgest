<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Test Cam√©ra Simple</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background: #1a1a2e;
      color: white;
    }
    h1 { color: #8be9fd; }
    video {
      width: 100%;
      max-width: 640px;
      border: 3px solid #8be9fd;
      border-radius: 10px;
      margin: 20px 0;
    }
    #status {
      padding: 15px;
      background: rgba(0,0,0,0.5);
      border-radius: 8px;
      margin: 10px 0;
      font-family: monospace;
    }
    .success { color: #51cf66; }
    .error { color: #ff6b6b; }
    .info { color: #8be9fd; }
  </style>
</head>
<body>
  <h1>üé• Test d'Acc√®s Cam√©ra</h1>
  <div id="status">‚è≥ D√©marrage...</div>
  <video id="video" autoplay playsinline muted></video>

  <script>
    const video = document.getElementById('video');
    const status = document.getElementById('status');

    async function testCamera() {
      try {
        status.innerHTML = '<span class="info">üì∑ Demande d\'acc√®s √† la cam√©ra...</span>';
        console.log('Demande getUserMedia...');

        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: 'user' },
          audio: false
        });

        console.log('‚úì Acc√®s accord√© !');
        video.srcObject = stream;

        video.onloadedmetadata = () => {
          video.play();
          status.innerHTML = '<span class="success">‚úÖ CAM√âRA FONCTIONNE !</span><br>' +
            'R√©solution: ' + video.videoWidth + 'x' + video.videoHeight;
          console.log('‚úì Vid√©o active:', video.videoWidth, 'x', video.videoHeight);
        };

      } catch (error) {
        console.error('‚ùå Erreur:', error);
        let msg = '<span class="error">‚ùå ERREUR: ' + error.name + '</span><br><br>';

        if (error.name === 'NotAllowedError') {
          msg += 'Vous avez <b>refus√©</b> l\'acc√®s √† la cam√©ra.<br>';
          msg += 'Cliquez sur l\'ic√¥ne üîí dans la barre d\'adresse<br>';
          msg += 'et autorisez l\'acc√®s √† la cam√©ra.';
        } else if (error.name === 'NotFoundError') {
          msg += 'Aucune cam√©ra d√©tect√©e.';
        } else if (error.name === 'NotReadableError') {
          msg += 'La cam√©ra est utilis√©e par une autre application.';
        } else {
          msg += error.message;
        }

        status.innerHTML = msg;
      }
    }

    console.log('üöÄ D√©marrage test cam√©ra...');
    console.log('URL:', window.location.href);
    console.log('Navigateur:', navigator.userAgent);

    // V√©rifier que getUserMedia existe
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      console.log('‚úì getUserMedia disponible');
      testCamera();
    } else {
      console.error('‚ùå getUserMedia non support√©');
      status.innerHTML = '<span class="error">‚ùå Votre navigateur ne supporte pas getUserMedia</span>';
    }
  </script>
</body>
</html>
